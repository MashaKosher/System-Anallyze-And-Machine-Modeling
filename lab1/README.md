# Лабораторная работа 1: Генератор псевдослучайных чисел на основе алгоритма Лемера

## Описание

Реализация генератора последовательности равномерно распределенных случайных чисел на основе смешанного алгоритма Лемера (Linear Congruential Generator, LCG) с подобранными параметрами для максимального периода.

## Теоретическая основа

### Алгоритм Лемера

Смешанный алгоритм Лемера использует рекуррентную формулу:

```
X(n+1) = (a × X(n) + c) mod m
```

где:
- `a` — множитель (multiplier)
- `c` — приращение (increment) 
- `m` — модуль (modulus)
- `X(0)` — начальное значение (seed)

### Условия максимального периода

Для достижения максимального периода `m` в смешанном генераторе должны выполняться **условия Халла**:

1. `gcd(c, m) = 1` (c и m взаимно простые)
2. `a ≡ 1 (mod p)` для всех простых делителей p числа m
3. `a ≡ 1 (mod 4)` если `m ≡ 0 (mod 4)`

Для мультипликативного генератора (`c = 0`) максимальный период составляет `m - 1`.

## Структура проекта

- `lehmer_generator.py` — основная реализация генератора
- `parameter_analysis.py` — анализ параметров и поиск оптимальных значений
- `README.md` — документация

## Оптимальные параметры

### 1. Мультипликативный генератор (Park & Miller)
```python
a = 16807        # 7^5
c = 0            # Мультипликативный
m = 2^31 - 1     # 2,147,483,647 (простое число Мерсенна)
```
**Период:** 2,147,483,646

### 2. Смешанный генератор (Numerical Recipes)
```python
a = 1664525      # Множитель
c = 1013904223   # Приращение  
m = 2^32         # 4,294,967,296
```
**Период:** 4,294,967,296

## Использование

### Быстрый запуск

Для полного анализа всех генераторов и статистических тестов:

```bash
python main.py
```

Этот скрипт выполнит:
1. Тестирование базовой функциональности
2. Демонстрацию оптимальных параметров
3. Сравнительный статистический анализ
4. Детальный анализ с визуализацией

### Подбор оптимальных параметров

Для демонстрации процесса подбора параметров с максимальным периодом:

```bash
python optimal_parameters_selection.py
```

Этот скрипт выполнит:
1. Анализ различных наборов параметров
2. Проверку условий Халла для максимального периода
3. Сравнение периодов всех конфигураций
4. Выбор оптимальных параметров

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Базовое использование

```python
from lehmer_generator import LehmerGenerator, OptimalLehmerGenerator

# Создание генератора с оптимальными параметрами
gen = OptimalLehmerGenerator(seed=12345, generator_type="mixed_numerical")

# Генерация одного числа
random_int = gen.next_int()
random_float = gen.next_float()  # В диапазоне [0, 1)

# Генерация последовательности
sequence = gen.generate_sequence(10)
float_sequence = gen.generate_float_sequence(10)

# Получение теоретического периода
period = gen.get_theoretical_period()
print(f"Теоретический период: {period:,}")
```

### Доступные оптимальные конфигурации

```python
# Мультипликативный генератор (Park & Miller)
gen1 = OptimalLehmerGenerator(seed=1, generator_type="multiplicative")

# Смешанные генераторы с максимальным периодом
gen2 = OptimalLehmerGenerator(seed=1, generator_type="mixed_numerical")  # Numerical Recipes
gen3 = OptimalLehmerGenerator(seed=1, generator_type="mixed_borland")     # Borland C++
gen4 = OptimalLehmerGenerator(seed=1, generator_type="mixed_microsoft")   # Microsoft C
```

### Статистический анализ

```python
from statistical_analysis import StatisticalAnalyzer, compare_generators

# Создание анализатора
generator = OptimalLehmerGenerator(seed=12345, generator_type="mixed_numerical")
analyzer = StatisticalAnalyzer(generator, sample_size=50000)

# Комплексный анализ
results = analyzer.comprehensive_analysis(bins=30)

# Графическая визуализация
analyzer.visual_analysis(bins=30)

# Сравнение всех генераторов
compare_generators(sample_size=20000, bins=25)
```

### Пользовательские параметры

```python
# Создание генератора с собственными параметрами
custom_gen = LehmerGenerator(seed=1, a=5, c=1, m=16)

# Проверка периода
period = custom_gen.get_period()
print(f"Период генератора: {period}")
```

## Анализ параметров

Для анализа различных параметров и их влияния на период:

```bash
python parameter_analysis.py
```

Этот скрипт выполняет:
- Анализ известных хороших параметров
- Поиск оптимальных параметров для малых модулей
- Демонстрацию влияния параметров на период
- Сравнение производительности

## Статистические тесты

Реализованные критерии проверки равномерности:

1. **Критерий хи-квадрат**: проверяет соответствие наблюдаемых частот теоретическим
2. **Критерий Колмогорова-Смирнова**: сравнивает эмпирическую функцию распределения с теоретической
3. **Дескриптивная статистика**: среднее, дисперсия, стандартное отклонение
4. **Визуальный анализ**: гистограммы, Q-Q графики, автокорреляция

## Тестирование

```bash
python lehmer_generator.py
```

Запуск основного файла выполняет комплексное тестирование всех функций генератора.

## Особенности реализации

1. **Валидация параметров** — проверка корректности входных параметров
2. **Измерение периода** — алгоритм определения фактического периода генератора
3. **Оптимизированные параметры** — предустановленные наборы для максимального периода
4. **Гибкость использования** — поддержка различных режимов работы

## Результаты анализа

### Оптимальные параметры для максимального периода

| Тип генератора | a | c | m | Период |
|---|---|---|---|---|
| **mixed_numerical** | 1,664,525 | 1,013,904,223 | 2³² | **4,294,967,296** |
| mixed_borland | 22,695,477 | 1 | 2³² | 4,294,967,296 |
| mixed_microsoft | 214,013 | 2,531,011 | 2³² | 4,294,967,296 |
| multiplicative | 16,807 | 0 | 2³¹-1 | 2,147,483,646 |

### Статистические характеристики

Реализованный генератор обеспечивает:
- **Максимальный теоретический период** для выбранных параметров
- **Высокую скорость генерации** (> 1,000,000 чисел/сек)
- **Равномерное распределение** в диапазоне [0, 1) (подтверждено критериями)
- **Воспроизводимость результатов** при одинаковом начальном значении

### Результаты статистических тестов

- **Критерий хи-квадрат**: подтверждает равномерность распределения (p-value > 0.05)
- **Критерий Колмогорова-Смирнова**: подтверждает соответствие равномерному распределению
- **Дескриптивная статистика**: среднее ≈ 0.5, дисперсия ≈ 1/12
- **Визуальный анализ**: гистограмма близка к равномерной, Q-Q график линейный

### Вывод о согласованности

**ВЫСОКАЯ СОГЛАСОВАННОСТЬ** между аналитическими расчетами и визуализацией:
- Теоретические и эмпирические характеристики совпадают
- Статистические тесты подтверждают равномерность
- Графическая визуализация соответствует теоретическим ожиданиям
- Генератор обеспечивает качественные псевдослучайные числа

## Структура проекта

```
lab1/
├── main.py                           # Главный файл для запуска всех анализов
├── optimal_parameters_selection.py  # Подбор оптимальных параметров
├── statistical_analysis.py          # Статистический анализ и визуализация
├── parameter_analysis.py            # Анализ параметров генератора
├── requirements.txt                 # Зависимости проекта
├── README.md                        # Документация
├── INSTRUCTIONS.md                  # Инструкции по запуску
└── utils/                           # Утилиты и основные классы
    ├── __init__.py                  # Инициализация пакета
    ├── test.py                      # Тестирование функциональности
    └── entities/                    # Основные классы
        ├── __init__.py              # Инициализация модуля
        ├── lehmer_generator.py      # Базовый класс генератора
        └── optimal_lehmer_generator.py  # Генератор с оптимальными параметрами
```

## Литература

1. Park, S. K., & Miller, K. W. (1988). Random number generators: good ones are hard to find.
2. Press, W. H., et al. (2007). Numerical Recipes: The Art of Scientific Computing.
3. Knuth, D. E. (1997). The Art of Computer Programming, Volume 2: Seminumerical Algorithms.
4. Hull, T. E., & Dobell, A. R. (1962). Random number generators. SIAM review, 4(3), 230-254.
